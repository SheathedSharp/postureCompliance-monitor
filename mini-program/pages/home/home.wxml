<user-btn />

<view class="open">
  <view class="start" style="position:relative;height: 350px;">
    <image src="/image/home/circle.png" class="circle {{degreeContext.data.recording?'doCircle':''}}" mode="aspectFill"></image>
    <image src="/image/home/startbg.png" mode="aspectFill" style="height:140px;width:140px;position:absolute;left:0;right: 0;margin:auto;z-index:2;top:0;bottom: 0;transform: scale(2.2);"></image>
    <image wx:if="{{!degreeContext.data.recording}}" bindtap="startRecord" src="/image/home/startbtn.png" mode="aspectFill" style="height:42px;width: 42px;z-index:3;position:absolute;top:0;left:0;right: 0;margin:auto;bottom: 0;"></image>
    <image wx:else src="/image/home/stopbtn.png" bindtap="simulateDataUpload" mode="aspectFill" style="height:42px;width: 42px;z-index:3;position:absolute;top:0;left:0;right: 0;margin:auto;bottom: 0;"></image>
  </view>
  <!-- 状态盒子 -->
  <view class="status-box" wx:if="{{degreeContext.data.bleopen}}">
    <image wx:if="{{recordTotalNum!=0}}" src="../../image/home/retransmission.png" mode="" class="retransmission" bind:tap="retransmitDeviceRecord" />
    <view class="record-num-box">设备内记录条数：<text style="color: white;">{{recordTotalNum}}</text></view>
    <image src="../../image/home/empty.png" mode="" class="empty" bind:tap="emptyDeviceRecord" />

  </view>
  <!-- <view class="standby">待机</view> -->
</view>
<view style="width:90%;margin:0 auto;justify-content: space-between;display: flex;">

  <!-- 连接蓝牙设备 -->
  <view style="display: flex; flex-direction: row; align-items: center; color: white;">
    <image wx:if="{{degreeContext.data.deviceId}}" style="height: 80rpx; width: 80rpx;" src="{{degreeContext.data.bleopen ? '../../image/home/connect_bluetooth_success.png' : '../../image/home/connect_bluetooth_fail.png'}}" bindtap="blechange" data-bleopen="{{degreeContext.data.bleopen}}">
    </image>
    <view wx:if="{{degreeContext.data.deviceId && degreeContext.data.bleopen}}">已连接</view>
    <view wx:if="{{degreeContext.data.deviceId && !degreeContext.data.bleopen}}">未连接</view>
  </view>

  <!-- 扫描可用蓝牙设备 -->
  <view style="display: flex; flex-direction: row; align-items: center; color: white;">
    <view wx:if="{{degreeContext.data.deviceId}}"> 当前设备{{degreeContext.data.deviceName}}</view>
    <view wx:if="{{!degreeContext.data.deviceId}}" style="margin-left: 5px;">扫描可用蓝牙设备</view>
    <image style="width: 80rpx; height: 80rpx;" src="../../image/home/scan_bluetooth.png" mode="" bindtap="showblue" />
  </view>

</view>

<view class="scontainer2" wx:if="{{ishow}}">
  <view class="title">蓝牙设备列表</view>
  <view class="list">
    <block wx:for="{{devices}}" wx:key="index">
      <view class="item" wx:if="{{item.name}}" bindtap="setdata" data-device="{{item}}" data-name="{{item.name}}">
        <view class="name">{{item.name}}</view>
        <view class="rssi">信号强度：{{item.RSSI}}</view>
      </view>
    </block>
  </view>
</view>


<view class="doctor" wx:if="{{message.length == 0}}">
  <view class="dian"></view>
  <view>
    <image src="/image/home/message.png"></image>
  </view>
  <view class="row" bind:longpress="orderContainerShow">
    <view class="row1">
      <text class="name">消息通知</text>
      <!-- <button bind:tap="f0301">获取三轴角度 连续读取</button>
      <button bind:tap="f0302">获取三轴角度 单次读取</button>
      <button bind:tap="f0303">获取三轴角度 停止读取</button> -->
    </view>
    <text class="message">
    </text>
  </view>
</view>


<view class="doctor" wx:else>
  <view class="dian"></view>
  <view>
    <image src="https://ylsh.top/assets/doctoravatar.jpeg"></image>
  </view>
  <view class="row">
    <view class="row1">
      <text class="name">郑医生</text>
      <text class="time">9:30</text>
    </view>
    <text class="message">给您发来一条通知</text>
  </view>
</view>

<!-- 发送特殊命令帧盒子 -->
<van-popup show="{{ orderContainerIsShow }}" bind:close="orderContainerClose" round position="bottom" custom-style="height: 15%">
  <view style="display: flex; align-items: center;justify-content: center; width: 100%; height: 100%;flex-direction: column ;">
    <van-field model:value="{{ specialOrder }}" center clearable left-icon="share-o" label="发送命令帧" placeholder="请输入命令帧" border="{{ false }}" use-button-slot>
      <van-button slot="button" size="small" type="info" round bind:click="sendSpecialOrder">
        发送
      </van-button>
    </van-field>
    <view style="margin-top: 20rpx; width: 100%; display: flex; flex-direction: row; justify-content: space-around;">
      <van-button type="primary" bind:click="executeFixFuction1">FixFuction1</van-button>
      <van-button disabled type="primary">FixFuction2</van-button>
      <van-button disabled type="primary">FixFuction3</van-button>
    </view>

  </view>
</van-popup>

<!-- 数据上传进度盒子 -->
<upload-progress style="position: absolute; z-index: 4;" show="{{uploadProgressIsShow}}" active="{{uploadProgressStep}}" recordTotalNum="{{uploadRecordTotalNum}}" recordIndex="{{uploadRecordIndex}}"></upload-progress>

<!-- <view class="news-item">
	<view class="list1">
		<view class="thumb">
			<image src="https://ylsh.top/assets/eyeball.jpeg"></image>
		</view>
		<view class="info">
			<text class="title">认识视网膜脱落</text>
			<view class="newsinfo">
				<text class="newstime">2022-05-13 19:06</text>
				<text class="source">来源：成都医报</text>
			</view>
		</view>
	</view>
	<view class="list1">
		<view class="thumb">
			<image src="https://ylsh.top/assets/%E8%A7%86%E7%BD%91%E8%86%9C%E8%84%B1%E8%90%BD.jpeg"></image>
		</view>
		<view class="info">
			<text class="title">首大李巧宪：出现视网膜脱前兆，千万不要拖延</text>
			<view class="newsinfo">
				<text class="newstime">2022-05-13 19:06</text>
				<text class="source">来源：中国医疗</text>
			</view>
		</view>
	</view>
	<view class="list1">
		<view class="thumb">
			<image src="https://ylsh.top/assets/%E8%A7%86%E7%BD%91%E8%86%9C%E8%84%B1%E8%90%BD.jpeg"></image>
		</view>
		<view class="info">
			<text class="title">认识视网膜脱落</text>
			<view class="newsinfo">
				<text class="newstime">2022-05-13 19:06</text>
				<text class="source">来源：成都医报</text>
			</view>
		</view>
	</view>
</view> -->